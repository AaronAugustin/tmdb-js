<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>tmdb-js/sections/types/movie.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-tmdb-js.Tmdb.html">Tmdb</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js.Tmdb.html#getAuthenticator">getAuthenticator</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js.Tmdb.html#getMovies">getMovies</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js.Tmdb.html#getSearcher">getSearcher</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js.Tmdb.html#getTvShows">getTvShows</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-tmdb-js_api.TmdbApiUser.html">TmdbApiUser</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-tmdb-js_api.TmdbQuerier.html">TmdbQuerier</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-tmdb-js_authentication.Authenticator.html">Authenticator</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_authentication.Authenticator.html#createGuestSession">createGuestSession</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_authentication.Authenticator.html#createSession">createSession</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_authentication.Authenticator.html#deleteSession">deleteSession</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-tmdb-js_search.Searcher.html">Searcher</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_search.Searcher.html#multiSearch">multiSearch</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-tmdb-js_sections.Section.html">Section</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-tmdb-js_sections.Subsection.html">Subsection</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.MovieSection.html">MovieSection</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.MovieSection.html#getMovie">getMovie</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.MovieSubsection.html">MovieSubsection</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.MovieSubsection.html#deleteRating">deleteRating</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.MovieSubsection.html#getAlternativeTitles">getAlternativeTitles</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.MovieSubsection.html#getChanges">getChanges</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.MovieSubsection.html#getCredits">getCredits</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.MovieSubsection.html#getDetails">getDetails</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.MovieSubsection.html#getExternalIds">getExternalIds</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.MovieSubsection.html#getImages">getImages</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.MovieSubsection.html#getKeywords">getKeywords</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.MovieSubsection.html#getLists">getLists</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.MovieSubsection.html#getRecommendations">getRecommendations</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.MovieSubsection.html#getReleaseDates">getReleaseDates</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.MovieSubsection.html#getReviews">getReviews</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.MovieSubsection.html#getSimilarMovies">getSimilarMovies</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.MovieSubsection.html#getTranslations">getTranslations</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.MovieSubsection.html#getVideos">getVideos</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.MovieSubsection.html#rate">rate</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.TvShowSection.html">TvShowSection</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.TvShowSection.html#getTvShow">getTvShow</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.TvShowSubsection.html">TvShowSubsection</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.TvShowSubsection.html#getAlternativeTitles">getAlternativeTitles</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.TvShowSubsection.html#getChanges">getChanges</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.TvShowSubsection.html#getContentRatings">getContentRatings</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.TvShowSubsection.html#getCredits">getCredits</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.TvShowSubsection.html#getDetails">getDetails</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.TvShowSubsection.html#getEpisodeGroups">getEpisodeGroups</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.TvShowSubsection.html#getExternalIds">getExternalIds</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.TvShowSubsection.html#getImages">getImages</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.TvShowSubsection.html#getKeywords">getKeywords</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.TvShowSubsection.html#getRecommendations">getRecommendations</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.TvShowSubsection.html#getReviews">getReviews</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.TvShowSubsection.html#getScreenedTheatrically">getScreenedTheatrically</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.TvShowSubsection.html#getSimilarTvShows">getSimilarTvShows</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.TvShowSubsection.html#getTranslations">getTranslations</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.TvShowSubsection.html#getVideos">getVideos</a></span></li><li class="nav-heading">Modules</li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-tmdb-js.html">tmdb-js</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-tmdb-js_api.html">tmdb-js/api</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-tmdb-js_authentication.html">tmdb-js/authentication</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-tmdb-js_search.html">tmdb-js/search</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_search.html#~searchPage">searchPage</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-tmdb-js_search.html#~searchPages">searchPages</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-tmdb-js_sections.html">tmdb-js/sections</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-tmdb-js_sections_types.html">tmdb-js/sections/types</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-utils.html">utils</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-utils.html#.createGuestSession">createGuestSession</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-utils.html#.createLoginSession">createLoginSession</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-utils.html#.createSession">createSession</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-utils.html#.deleteSession">deleteSession</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-utils.html#.getRequestToken">getRequestToken</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-utils.html#.getSectionData">getSectionData</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-utils.html#.getSectionDetails">getSectionDetails</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-utils.html#.httpRequest">httpRequest</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-utils.html#.parseHttpRequest">parseHttpRequest</a></span></li>
</nav>

<div id="main">
    
    <h1 class="page-title">tmdb-js/sections/types/movie.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**@module tmdb-js/sections/types */

// HTTP utilities
const httpUtils = require('../../../utils/http_utils');
const httpMethod = httpUtils.httpMethod;

// TMDB utilities
const tmdbUtils = require('../../../utils/tmdb_utils');
const sections = tmdbUtils.sections;
const dataTypes = tmdbUtils.dataTypes;

// Sections
const section = require('../section');
const Section = section.Section;
const Subsection = section.Subsection;

/**
 * Can get and handle movie data on TMDB.
 */
exports.MovieSubsection = class extends Subsection {

    /**
     * Sets properties.
     * @param {string} apiKey The TMDB API key.
     * @param {Number} movieId The id of the movie.
     * @param {string} language The language of queries, the default is "en-US".
     */
    constructor(apiKey, movieId, language = "en-US") {
        super(apiKey, sections.MOVIE, movieId, language);
    }

    /**
     * Gets all details about the movie in question.
     * @returns A Promise of movie details.
     */
    getDetails() {
        return tmdbUtils.getSectionDetails(
            this._section, this._subSectionId, this._apiKey, this._language);
    }

    // TODO [David Hall, 2020-07-05]: getAccountStates

    /**
     * Gets the alternative titles of the movie in question.
     * @returns A Promise of alternative titles.
     */
    getAlternativeTitles() {
        return this._getSectionData(dataTypes.ALTERNATIVE_TITLES);
    }

    /**
     * Gets the changes of the movie in question.
     * @returns A Promise of movie changes.
     */
    getChanges() {
        return this._getSectionData(dataTypes.CHANGES);
    }
        
    /**
     * Gets the credits of the movie in question.
     * @returns A Promise of movie credits.
     */
    getCredits() {
        return this._getSectionData(dataTypes.CREDITS);
    }

    /**
     * Gets the external IDs of the movie in question.
     * @returns A Promise of external IDs.
     */
    getExternalIds() { 
        return this._getSectionData(dataTypes.EXTERNAL_IDS);
    }

    /**
     * Gets the images of the movie in question.
     * @returns A Promise of movie images.
     */
    getImages() {
        return this._getSectionData(dataTypes.IMAGES);
    }

    /**
     * Gets the keywords of the movie in question.
     * @returns A Promise of movie keywords.
     */
    getKeywords() {
        return this._getSectionData(dataTypes.KEYWORDS);
    }

    /**
     * Gets the release dates of the movie in question.
     * @returns A Promise of movie release dates.
     */
    getReleaseDates() {
        return this._getSectionData(dataTypes.RELEASE_DATES);
    }

    /**
     * Gets the videos of the movie in question.
     * @returns A Promise of movie videos.
     */
    getVideos() {
        return this._getSectionData(dataTypes.VIDEOS);
    }

    /**
     * Gets the translations of the movie in question.
     * @returns A Promise of movie translations.
     */ 
    getTranslations() {
        return this._getSectionData(dataTypes.TRANSLATIONS);
    }

    /**
     * Gets the recommendations based on the movie in question.
     * @returns A Promise of recommendations.
     */
    getRecommendations() {
        return this._getSectionData(dataTypes.RECOMMENDATIONS);
    }

    /**
     * Gets the similar movies to the movie in question.
     * @returns A Promise of similar movies.
     */
    getSimilarMovies() {
        return this._getSectionData(dataTypes.SIMILAR_MOVIES);
    }

    /**
     * Gets the reviews of the movie in question.
     * @returns A Promise of movie reviews.
     */
    getReviews() {
        return this._getSectionData(dataTypes.REVIEWS);
    }

    /**
     * Gets the lists of the movie in question.
     * @returns A Promise of lists.
     */
    getLists() {
        return this._getSectionData(dataTypes.LISTS);
    }

    #notBothSessionIdsMsg = "Can't use both a session ID and a guest session ID!";
    #noSessionIdMsg = "Can't perform action without some sort of a session ID.";

    /**
     * Rates the movie in question
     * @param {Number} rating The rating, in the range [0.5, 10].
     * @param {string} sessionId The session ID. Use this or the guest session ID.
     * @param {string} guestSessionId The guest session ID. Use this or the session ID.
     * @returns A Promise of a boolean value, which will be true if the rating was successful.
     */
    async rate(rating, sessionId = null, guestSessionId = null) {

        if (sessionId &amp;&amp; guestSessionId) {
            throw this.#notBothSessionIdsMsg;
        }

        var rateUrl = tmdbUtils.baseUrl + `movie/${this._subSectionId}/rating?api_key=${this._apiKey}`;

        if (sessionId) {
            rateUrl += "&amp;session_id=" + sessionId;
        } else if (guestSessionId) {
            rateUrl += "&amp;guest_session_id=" + guestSessionId;
        } else {
            throw this.#noSessionIdMsg;
        }        

        var response = await httpUtils.parseHttpRequest(
            rateUrl,
            httpMethod.POST,
            JSON.parse,
            httpUtils.jsonContentType,

            // Ensure that the rating is in the acceptable range
            JSON.stringify({ "value": Math.min(Math.max(0.5, rating), 10) }));

        return response &amp;&amp; response.status_code == 12;
    }

    /**
     * Deletes the rating from the movie in question.
     * @param {string} sessionId The session ID. Use this or the guest session ID.
     * @param {string} guestSessionId The guest session ID. Use this or the session ID.
     * @returns A Promise of a boolean value, which will be true if the deletion was successful.
     */
    async deleteRating(sessionId = null, guestSessionId = null) {

        if (sessionId &amp;&amp; guestSessionId) {
            throw this.#notBothSessionIdsMsg;
        }

        var rateUrl = tmdbUtils.baseUrl + `movie/${this._subSectionId}/rating?api_key=${this._apiKey}`;

        if (sessionId) {
            rateUrl += "&amp;session_id=" + sessionId;
        } else if (guestSessionId) {
            rateUrl += "&amp;guest_session_id=" + guestSessionId;
        } else {
            throw this.#noSessionIdMsg;
        }

        var response = await httpUtils.parseHttpRequest(
            rateUrl,
            httpMethod.DELETE,
            JSON.parse,
            httpUtils.jsonContentType);

        return response &amp;&amp; response.status_code == 13;
    }

}

/**
 * Can get data about movies in general from the TMDB API.
 */
exports.MovieSection = class extends Section {
    
    /**
     * Sets properties.
     * @param {string} apiKey The TMDB API key.
     * @param {string} language The language of queries, the default is "en-US".
     */
    constructor(apiKey, language = "en-US") {
        super(apiKey, sections.MOVIE, language);
    }

    /**
     * Gets a MovieSubsection, based on the passed ID.
     * @param {Number} movieId The movie ID.
     * @returns A MovieSubsection.
     */
    getMovie(movieId) {
        return new exports.MovieSubsection(this._apiKey, movieId, this._language);
    }

    /**
     * Gets the latest movies.
     */
    // TODO [David Hall, 2020-07-05] getLatest method

    /**
     * Gets a list of movies currently playing in theatres.
     */
    // TODO [David Hall, 2020-07-05] getNowPlaying method

    /**
     * Gets popular movies.
     */
    // TODO [David Hall, 2020-07-05] getPopular method

    /**
     * Gets top rated movies.
     */
    // TODO [David Hall, 2020-07-05] getTopRated method

    /**
     * Gets upcoming movies.
     */
    // TODO [David Hall, 2020-07-05] getUpcoming method
}</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.4</a> on Mon Jul 06 2020 19:56:30 GMT+0000 (Coordinated Universal Time) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
